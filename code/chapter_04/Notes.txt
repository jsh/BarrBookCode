Storing Data with Amazon S3

Chapter 4: Storing Data with Amazon S3

 

 

The code in this directory now works for me.

 

You should be able to read Chapter 4 of the Barr book and run these example
programs from it without a hiccup; you should also read the chapter to learn
how to run them and why they work.

 

If you do have problems, please fix them and tell me how you did it.  You can
even check your fixes into the GitHub repo, but you'll have to ask me for
commit access. (Which I'll be delighted to give.)

Most Scripts Run from the Command Line

 

I've converted the scripts to work with the AWSSDKforPHP toolkit.  All the ones
that are supposed to work from the command line will now do so correctly.

 

A few scripts required minor bug fixes.  In other cases, there are now easier
ways to do the programs, but I've avoided the temptation to fix them if the
current versions work. My goal is to minimumize changes, and maximize
compatibility with the book.

 

Three Scripts Don't Work from the Command Line

 

Some scripts in this directory aren't meant to be run from the command line.

 

list_bucket_objects_page.php

list_bucket_objects_page_thumbs.php

list_buckets_page.php

 

They have no shebang (#!) line, and their names all have "_page".  They
generate web pages.

 

Making the "_page" Scripts Work

 

Two options here.

 

The first way

 

Install a web server on your box and configure it to serve up these pages.

 

 + install a web server

 

sudo apt-get install apache2

 

There web is littered with instructions on how to get web servers all set up. I
won't duplicate that effort. Google's your friend.

 

 + put the required files into /var/www

 

cd code/chapter_04

sudo cp -r include *_page* /var/www

 

 + Once you have buckets, and objects in them, go visit these pages in your
    browser

 

firefox http://localhost/list_buckets_page.php

firefox http://localhost/list_bucket_objects_page.php?bucket=
<your-bucket-name-here>

 

The command-line script thumbnail_bucket.php uses a bucketful of images to
creates a second, bucketful of thumbnails.

 

You can look at these with your browser, too.

firefox http://localhost/list_bucket_objects_thumbs_page.php?bucket=
<your-bucket-name-here>

 

Is there a better way to do all this? Show me how.

 

The second way

 

If you don’t want to go through the hassle of installing and configuring a web
server on your machine, you can just to skip this. In the next chapter, you’ll
launch a web server in the cloud. At that point, you can install all this stuff
on the web server and do it there.

Forcing an Argument

 

The book will tell you to set BOOK_BUCKET in include/book.inc.php.  Don't
bother. All scripts that need a bucket name require it on the command line. I
changed this because I hate making people hand-edit configuration files; it’s
error- and forgetting-prone. In contrast, commands can tell you when you forget
to supply an argument.

 

You can set BOOK_BUCKET if you want.  Following the model provided by a couple
of the scripts in this chapter, an argument of ‘-’ means BOOK_BUCKET.

 

The _page scripts, above, that are run by the server are exceptions to this,
sort of. For them, you specify the bucket name in the url, like this:

 

http://localhost/list_bucket_objects_page.php?bucket=<bucketname>

Looking at What You've Done

 

One of these scripts lets you create buckets. Another lets you upload files to
them. The rest let you check whether you succeeded. What more could you want?

 

I recommend looking at them in the AWS Management Console and S3Fox, too.

 

 + Looking at other people's stuff will give you good ideas.
 2. It's often useful to know what everyone else is using.
 3. You only have to roll your own if it's fun.
 4. Now you have a better idea what you're looking at -- what AMC and S3Fox are
    doing under the covers.

 

Nothing is perfect.

 

The AWMC is slower than molasses in winter. My browser regularly whines "A
script on this page may be busy or is not responding." I just hit "Continue."
It's not hung, it's slow. And I've seen things that don't work in S3Fox but do
in the AMC. Both GUIs need manual refreshes whenever I do anything interesting.

 

But both give you far more info than the PHP scripts, as they stand.
 Conversely, the PHP scripts are hackable to do what you want..

 

It's all trade-offs.

 

This work is licensed under the Creative Commons Attribution 3.0 Unported
License. To view a copy of this license, visit http://creativecommons.org/
licenses/by/3.0/ or send a letter to Creative Commons, 171 Second Street, Suite
300, San Francisco, California, 94105, USA.

 

 

 

Edit this page (if you have permission)–Published by Google Docs–Report Abuse
–Updated automatically every 5 minutes
